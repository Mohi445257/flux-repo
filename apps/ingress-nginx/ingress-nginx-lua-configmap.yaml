apiVersion: v1
kind: ConfigMap
metadata:
  name: ingress-nginx-lua-plugins
  namespace: ingress-nginx
data:
  redirect-404-plugin.lua: |
    -- Redirect 404s to /
    local function handle_not_found()
      ngx.status = ngx.HTTP_MOVED_TEMPORARILY
      ngx.header["Location"] = "/"
      return ngx.exit(ngx.HTTP_MOVED_TEMPORARILY)
    end

    return handle_not_found()
